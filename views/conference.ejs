<% script(cdn) %>
<% script(widgets.webRTC.js) %>
<% script(widgets.chat.js) %>
<% script(widgets.userColors.js) %>
<% script('/js/demo.js') %>

<% stylesheet(widgets.webRTC.css) %>
<% stylesheet(widgets.chat.css) %>
<% stylesheet('/css/conference.css') %>

<script type="text/javascript">
  $(document).ready(function() {
    var config = {
      url: '<%= url %>',
      room: '<%= room %>',
      token: '<%= token %>',
      webrtcContainer: $('#webrtc-container')[0],
      webrtcList: $('#webrtc-list')[0],
      chatContainer: $('#chat-container')[0]
    };

    // Auto Copy
    $('.join-url input').on('click', function() {
      this.select();
    });

    var supported = goinstant.widgets.WebRTC.supported;
    var supported = true; // TODO: remove this line

    if (!supported) {
      var error = 'Your browser does not support WebRTC. For an up-to-date' +
                  'list of supported browsers please see www.webrtc.org';

      console.log(error);

      return;
    }

    // Setup Demo
    var Demo = window.goinstant.WebRTCDemo;
    var demo = new Demo(config);
    demo.initialize(function(err) {
      if (err) {
        throw err;
      }
    });
  });
</script>

<div class="main">
  <section class="cf">
    <div id="webrtc-container" class="webrtc-container">
    </div>
    <aside>
      <div class="join-url">
        <span>Invite</span><input type="text" value="<%= joinURL %>" readonly />
      </div>
      <div id="chat-container" class="chat-container"></div>
    </aside>
  </section>
  <div id="webrtc-list" class="webrtc-list"></div>
</div>
<a href="https://github.com/goinstant/webrtc"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>